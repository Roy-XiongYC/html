<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.person.web.admin.repository.SchoolScoreMapper">
<resultMap id="BaseResultMap"  type="com.person.web.admin.model.SchoolScore" >
	<result column="id" property="id" jdbcType="VARCHAR" />
	<result column="student_id" property="studentId" jdbcType="VARCHAR" />
	<result column="project_id" property="projectId" jdbcType="VARCHAR" />
	<result column="sign_value" property="signValue" jdbcType="DOUBLE" />
	<result column="video_value" property="videoValue" jdbcType="DOUBLE" />
	<result column="nvideo_value" property="nvideoValue" jdbcType="DOUBLE" />
	<result column="class_value" property="classValue" jdbcType="DOUBLE" />
	<result column="vote_value" property="voteValue" jdbcType="DOUBLE" />
	<result column="brain_value" property="brainValue" jdbcType="DOUBLE" />
	<result column="discuss_value" property="discussValue" jdbcType="DOUBLE" />
	<result column="test_value" property="testValue" jdbcType="DOUBLE" />
	<result column="task_value" property="taskValue" jdbcType="DOUBLE" />
	<result column="guidance_value" property="guidanceValue" jdbcType="DOUBLE" />
	<result column="teacher_value" property="teacherValue" jdbcType="DOUBLE" />
	<result column="total_mark" property="totalMark" jdbcType="DOUBLE" />
	<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
	<result column="student_name" property="studentName" jdbcType="VARCHAR" />
	<result column="student_class" property="studentClass" jdbcType="VARCHAR" />
	<result column="project_name" property="projectName" jdbcType="VARCHAR" />
</resultMap> 
<sql id="Criteria_Where_Clause"> 
	<where> 
		<if test="params.id!=null">
			 and id=#{params.id}
		</if>
		<if test="params.studentId!=null">
			 and sc.student_id=#{params.studentId}
		</if>
		<if test="params.projectId!=null">
			 and sc.project_id=#{params.projectId}
		</if>
		<if test="params.studentIdLike!=null">
			 and sc.student_id like
				CONCAT('%',#{params.studentIdLike},'%')
		</if>
		<if test="params.studentNameLike!=null">
			 and st.student_name like
				CONCAT('%',#{params.studentNameLike},'%')
		</if>
		<if test="params.studentClass!=null">
			 and st.student_class =#{params.studentClass}
		</if>
		<if test="params.projectNameLike!=null">
			 and sp.project_name like
				CONCAT('%',#{params.projectNameLike},'%')
		</if>
		<if test="params.createTime!=null">
			 and sc.create_time=#{params.createTime}
		</if>
	</where> 
</sql> 
<sql id="Base_Column_List">
  id,sc.student_id,sc.project_id,sign_value,video_value,nvideo_value,class_value,vote_value,brain_value,discuss_value,test_value,task_value,guidance_value,teacher_value,total_mark,sc.create_time,st.student_name,st.student_class,sp.project_name
</sql> 
<select id="queryPage" resultMap="BaseResultMap" parameterType="com.person.framework.mybatis.Criteria"> 
	select 
	<include refid="Base_Column_List" />
	from t_school_score sc 
	left join t_school_student st on sc.student_id = st.student_id
	left join t_school_project sp on sc.project_id = sp.project_id
	<if test="params != null"> 
		<include refid="Criteria_Where_Clause" /> 
	</if> 
	<if test="orderBy!=null"> 
		order by ${orderBy} 
	</if> 
</select> 
<select id="queryPageCount" resultType="java.lang.Integer" parameterType="com.person.framework.mybatis.Criteria"> 
	select count(1) from t_school_score sc 
	left join t_school_student st on sc.student_id = st.student_id
	left join t_school_project sp on sc.project_id = sp.project_id
	<if test="params != null"> 
		<include refid="Criteria_Where_Clause" /> 
	</if> 
</select> 
<select id="queryEntity" resultMap="BaseResultMap" parameterType="java.lang.String">
	select 
	id,student_id,project_id,sign_value,video_value,nvideo_value,class_value,vote_value,brain_value,discuss_value,test_value,task_value,guidance_value,teacher_value,total_mark,create_time
	from t_school_score	where id = #{id}
</select>
<select id="queryByStu" resultMap="BaseResultMap" parameterType="com.person.framework.mybatis.Criteria">
	select id,student_id,project_id,sign_value,video_value,nvideo_value,class_value,vote_value,brain_value,discuss_value,test_value,task_value,guidance_value,teacher_value,total_mark,create_time
	from t_school_score	where student_id = #{params.studentId} and project_id = #{params.projectId}
</select>
<insert id="insert" parameterType="com.person.web.admin.model.SchoolScore"> 
	insert into t_school_score
	<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="id != null"> 
			id,
		</if>
		<if test="studentId != null"> 
			student_id,
		</if>
		<if test="projectId != null"> 
			project_id,
		</if>
		<if test="signValue != null"> 
			sign_value,
		</if>
		<if test="videoValue != null"> 
			video_value,
		</if>
		<if test="nvideoValue != null"> 
			nvideo_value,
		</if>
		<if test="classValue != null"> 
			class_value,
		</if>
		<if test="voteValue != null"> 
			vote_value,
		</if>
		<if test="brainValue != null"> 
			brain_value,
		</if>
		<if test="discussValue != null"> 
			discuss_value,
		</if>
		<if test="testValue != null"> 
			test_value,
		</if>
		<if test="taskValue != null"> 
			task_value,
		</if>
		<if test="guidanceValue != null"> 
			guidance_value,
		</if>
		<if test="teacherValue != null"> 
			teacher_value,
		</if>
		<if test="totalMark != null"> 
			total_mark,
		</if>
		<if test="createTime != null"> 
			create_time,
		</if>
	</trim>
	values
	<trim prefix="(" suffix=")" suffixOverrides=",">
	<if test="id != null"> 
		#{id},
	</if>
	<if test="studentId != null"> 
		#{studentId},
	</if>
	<if test="projectId != null"> 
		#{projectId},
	</if>
	<if test="signValue != null"> 
		#{signValue},
	</if>
	<if test="videoValue != null"> 
		#{videoValue},
	</if>
	<if test="nvideoValue != null"> 
		#{nvideoValue},
	</if>
	<if test="classValue != null"> 
		#{classValue},
	</if>
	<if test="voteValue != null"> 
		#{voteValue},
	</if>
	<if test="brainValue != null"> 
		#{brainValue},
	</if>
	<if test="discussValue != null"> 
		#{discussValue},
	</if>
	<if test="testValue != null"> 
		#{testValue},
	</if>
	<if test="taskValue != null"> 
		#{taskValue},
	</if>
	<if test="guidanceValue != null"> 
		#{guidanceValue},
	</if>
	<if test="teacherValue != null"> 
		#{teacherValue},
	</if>
	<if test="totalMark != null"> 
		#{totalMark},
	</if>
	<if test="createTime != null"> 
		#{createTime},
	</if>
	</trim>
</insert>
<insert id="insertList" parameterType="java.util.List"> 
	<foreach collection="list" item="record" index="index"
			separator=";">
		insert into t_school_score
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="record.id != null"> 
				id,
			</if>
			<if test="record.studentId != null"> 
				student_id,
			</if>
			<if test="record.projectId != null"> 
				project_id,
			</if>
			<if test="record.signValue != null"> 
				sign_value,
			</if>
			<if test="record.videoValue != null"> 
				video_value,
			</if>
			<if test="record.nvideoValue != null"> 
				nvideo_value,
			</if>
			<if test="record.classValue != null"> 
				class_value,
			</if>
			<if test="record.voteValue != null"> 
				vote_value,
			</if>
			<if test="record.brainValue != null"> 
				brain_value,
			</if>
			<if test="record.discussValue != null"> 
				discuss_value,
			</if>
			<if test="record.testValue != null"> 
				test_value,
			</if>
			<if test="record.taskValue != null"> 
				task_value,
			</if>
			<if test="record.guidanceValue != null"> 
				guidance_value,
			</if>
			<if test="record.teacherValue != null"> 
				teacher_value,
			</if>
			<if test="record.totalMark != null"> 
				total_mark,
			</if>
			<if test="record.createTime != null"> 
				create_time,
			</if>
		</trim>
		values
		<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="record.id != null"> 
			#{record.id},
		</if>
		<if test="record.studentId != null"> 
			#{record.studentId},
		</if>
		<if test="record.projectId != null"> 
			#{record.projectId},
		</if>
		<if test="record.signValue != null"> 
			#{record.signValue},
		</if>
		<if test="record.videoValue != null"> 
			#{record.videoValue},
		</if>
		<if test="record.nvideoValue != null"> 
			#{record.nvideoValue},
		</if>
		<if test="record.classValue != null"> 
			#{record.classValue},
		</if>
		<if test="record.voteValue != null"> 
			#{record.voteValue},
		</if>
		<if test="record.brainValue != null"> 
			#{record.brainValue},
		</if>
		<if test="record.discussValue != null"> 
			#{record.discussValue},
		</if>
		<if test="record.testValue != null"> 
			#{record.testValue},
		</if>
		<if test="record.taskValue != null"> 
			#{record.taskValue},
		</if>
		<if test="record.guidanceValue != null"> 
			#{record.guidanceValue},
		</if>
		<if test="record.teacherValue != null"> 
			#{record.teacherValue},
		</if>
		<if test="record.totalMark != null"> 
			#{record.totalMark},
		</if>
		<if test="record.createTime != null"> 
			#{record.createTime},
		</if>
		</trim>
	</foreach>
</insert>
<update id="updateList" parameterType="java.util.List">
	<foreach collection="list" item="record" index="index"
			separator=";">
		update t_school_score
		<set>
		<if test="record.signValue != null"> 
			sign_value = sign_value + #{record.signValue},
		</if>
		<if test="record.videoValue != null"> 
			video_value = video_value + #{record.videoValue},
		</if>
		<if test="record.nvideoValue != null"> 
			nvideo_value = nvideo_value + #{record.nvideoValue},
		</if>
		<if test="record.classValue != null"> 
			class_value = class_value + #{record.classValue},
		</if>
		<if test="record.voteValue != null"> 
			vote_value = vote_value + #{record.voteValue},
		</if>
		<if test="record.brainValue != null"> 
			brain_value = brain_value + #{record.brainValue},
		</if>
		<if test="record.discussValue != null"> 
			discuss_value = discuss_value + #{record.discussValue},
		</if>
		<if test="record.testValue != null"> 
			test_value = test_value + #{record.testValue},
		</if>
		<if test="record.taskValue != null"> 
			task_value = task_value + #{record.taskValue},
		</if>
		<if test="record.guidanceValue != null"> 
			guidance_value = guidance_value + #{record.guidanceValue},
		</if>
		<if test="record.teacherValue != null"> 
			teacher_value = teacher_value + #{record.teacherValue},
		</if>
		total_mark = (sign_value+video_value+nvideo_value+class_value+vote_value+brain_value+discuss_value+test_value+task_value)*0.6+(guidance_value+teacher_value)*0.4,
		</set>
		where id=#{record.id}
		<if test="record.signValue != null"> 
			and sign_value + #{record.signValue} >= 0
		</if>
		<if test="record.videoValue != null"> 
			and video_value + #{record.videoValue} >= 0
		</if>
		<if test="record.nvideoValue != null"> 
			and nvideo_value + #{record.nvideoValue} >= 0
		</if>
		<if test="record.classValue != null"> 
			and class_value + #{record.classValue} >= 0
		</if>
		<if test="record.voteValue != null"> 
			and vote_value + #{record.voteValue} >= 0
		</if>
		<if test="record.brainValue != null"> 
			and brain_value + #{record.brainValue} >= 0
		</if>
		<if test="record.discussValue != null"> 
			and discuss_value + #{record.discussValue} >= 0
		</if>
		<if test="record.testValue != null"> 
			and test_value + #{record.testValue} >= 0
		</if>
		<if test="record.taskValue != null"> 
			and task_value + #{record.taskValue} >= 0
		</if>
		<if test="record.guidanceValue != null"> 
			and task_value + #{record.guidanceValue} >= 0
		</if>
		<if test="record.teacherValue != null"> 
			and teacher_value + #{record.teacherValue} >= 0
		</if>
		<if test="record.totalMark != null"> 
			and total_mark + #{record.totalMark} >= 0
		</if>
	</foreach>
</update>
<update id="updateByCriteria" parameterType="com.person.framework.mybatis.Criteria">
	update t_school_score
	<set>
	<if test="record.id != null"> 
		id = #{record.id},
	</if>
	<if test="record.studentId != null"> 
		student_id = #{record.studentId},
	</if>
	<if test="record.projectId != null"> 
		project_id = #{record.projectId},
	</if>
	<if test="record.signValue != null"> 
		sign_value = #{record.signValue},
	</if>
	<if test="record.videoValue != null"> 
		video_value = #{record.videoValue},
	</if>
	<if test="record.nvideoValue != null"> 
		nvideo_value = #{record.nvideoValue},
	</if>
	<if test="record.classValue != null"> 
		class_value = #{record.classValue},
	</if>
	<if test="record.voteValue != null"> 
		vote_value = #{record.voteValue},
	</if>
	<if test="record.brainValue != null"> 
		brain_value = #{record.brainValue},
	</if>
	<if test="record.discussValue != null"> 
		discuss_value = #{record.discussValue},
	</if>
	<if test="record.testValue != null"> 
		test_value = #{record.testValue},
	</if>
	<if test="record.taskValue != null"> 
		task_value = #{record.taskValue},
	</if>
	<if test="record.guidanceValue != null"> 
		guidance_value = #{record.guidanceValue},
	</if>
	<if test="record.teacherValue != null"> 
		teacher_value = #{record.teacherValue},
	</if>
	<if test="record.totalMark != null"> 
		total_mark = #{record.totalMark},
	</if>
	<if test="record.createTime != null"> 
		create_time = #{record.createTime},
	</if>
	</set>
	<if test="params != null">
		<include refid="Criteria_Where_Clause" />
	</if>
</update>
<delete id="deleteByCriteria" parameterType="com.person.framework.mybatis.Criteria">
	delete from t_school_score
	<if test="params != null">
		<include refid="Criteria_Where_Clause" />
	</if>
</delete>
<delete id="deleteById" parameterType="java.lang.String">
	delete from t_school_score
	where id = #{id}
</delete>
</mapper>
